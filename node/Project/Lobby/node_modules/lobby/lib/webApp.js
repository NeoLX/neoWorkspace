'use strict'

var fs = require('fs');
// var events = require('events');
// var url = require("url");
// var util = require('util');
// var express = require('express');
// var path = require('path');
// var cookie = require('cookie');
// var uuid = require('uuid');

function WebApp(){
    
    var _app, _webConfig;
    var _status;
    
    var init = function (app, path) {
        var self = this;
        _app = app;
        
        //初始化事件
		this.on(WebApp.Handles.onInited, this.serverInitHandle);
        
        fs.readFile(path, 'utf8', function (err, data) {
            self._webConfig = JSON.parse(data);
        });
        
    };
    
    var	statusChangeHandle = function(){
		switch(_status){
				case WebApp.Status.Inited:
					this.emit(WebApp.Handles.onInited);
                    break;                    
				default:
					break;
			}
	}
    
    //服务器启动事件
	this.serverInit = function(){
		//加载服务器配置
        // this.serverConf = require(this._rootDir + '/server.json');
        
        //服务器初始化完成
		this.setStatus(Lobby.Status.SERVER_INITED);
	}
	
    
    //添加路由
	this.addRouter = function(root, path){
		var self = this;

		return function(exists){
			if(exists){
				router.getInstance(root, path, self.setWebConfig());
			}
		}		
	}
}
util.inherits(WebApp,events.EventEmitter);

WebApp.Handles = {};
WebApp.Handles.onInited = 1;

WebApp.Status = {};
WebApp.Status.Inited = 1;

module.exports = WebApp;